<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>ğŸ€ Sniperâ€¯J GM æ¨¡æ“¬å™¨ v0.9.2 Lite+</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: sans-serif;
      background: #f4f4f4;
      padding: 10px;
      margin: 0;
    }
    h1, h2 {
      text-align: center;
      color: #2c3e50;
    }
    button {
      display: block;
      width: 100%;
      margin: 5px 0;
      padding: 12px;
      font-size: 18px;
      border-radius: 8px;
      border: none;
      background: #3498db;
      color: white;
      cursor: pointer;
    }
    button:disabled {
      background: #ccc;
      cursor: not-allowed;
    }
    .container {
      max-width: 500px;
      margin: auto;
    }
    .player {
      background: white;
      margin: 10px 0;
      padding: 10px;
      border-radius: 6px;
    }
    .player-info {
      margin-bottom: 5px;
    }
    #versionFooter {
      text-align: center;
      margin-top: 30px;
      font-size: 14px;
      color: #888;
    }
  </style>
</head>
<body>
<div class="container">
  <h1>ğŸ€ Sniperâ€¯J GM æ¨¡æ“¬å™¨</h1>
  <button id="showWarriorsBtn">å‹‡å£«é™£å®¹</button>
  <button id="showFreeAgentsBtn">è‡ªç”±å¸‚å ´</button>
  <button id="showTradeBtn">äº¤æ˜“ä¸­å¿ƒ</button>
  <button id="simulateGameBtn">æ¨¡æ“¬æ¯”è³½</button>
  <button id="resetTrainingBtn">é‡ç½®è¨“ç·´</button>
  <button id="clearBtn">æ¸…ç©ºå­˜æª”</button>
  <div id="dateDisplay"></div>
  <div id="moneyDisplay"></div>
  <div id="teamDisplay"></div>
  <div id="freeAgentsDisplay"></div>
  <div id="tradeDisplay"></div>
  <div id="gameResult"></div>
  <div id="versionFooter">ç‰ˆæœ¬ v0.9.2 Lite+</div>
</div>

<script>
(() => {
  const ratingMap = {"C":1,"C+":2,"B-":3,"B":4,"B+":5,"A-":6,"A":7,"A+":8,"S":9,"S+":10};
  const order = ["C","C+","B-","B","B+","A-","A","A+","S","S+"];
  let warriors, freeAgents, otherTeams, money, salaryCap, lastDate, picks, trainLimit;

  function defaultData() {
    return {
      warriors:[
        {name:"Stephen Curry",rating:"S",salary:35,trainProgress:0,trained:false},
        {name:"Klay Thompson",rating:"B+",salary:20,trainProgress:0,trained:false},
        {name:"Jonathan Kuminga",rating:"B",salary:15,trainProgress:0,trained:false}
      ],
      freeAgents:[
        {name:"Malik Beasley",rating:"B",salary:15,signChance:60},
        {name:"Robert Covington",rating:"B-",salary:12,signChance:50}
      ],
      otherTeams:{
        "é›·éœ†":[{name:"SGA",rating:"S",salary:34},{name:"Jalen Williams",rating:"A",salary:20}]
      },
      money:100, salaryCap:140, lastDate:null,
      picks:{"å‹‡å£«":2,"é›·éœ†":2},
      trainLimit:3
    };
  }

  function load(){
    const s = localStorage.getItem("sj_gm_lite");
    if(s) Object.assign(window, JSON.parse(s));
    else Object.assign(window, defaultData());
  }

  function save(){
    localStorage.setItem("sj_gm_lite", JSON.stringify({
      warriors, freeAgents, otherTeams, money, salaryCap, lastDate, picks, trainLimit
    }));
  }

  function renderStatus(){
    const now = new Date().toLocaleDateString();
    const sal = warriors.reduce((a, p) => a + p.salary, 0);
    document.getElementById("dateDisplay").textContent = "ä»Šå¤©ï¼š" + now;
    document.getElementById("moneyDisplay").textContent = `è³‡é‡‘:$${money}M å·¥è³‡:${sal}/${salaryCap}M é¦–è¼ªç±¤:${picks["å‹‡å£«"]}`;
  }

  function showWarriors(){
    const out = document.getElementById("teamDisplay");
    out.innerHTML = "<h2>ğŸ€ å‹‡å£«é™£å®¹</h2>";
    let trainedCount = warriors.filter(p => p.trained).length;
    warriors.forEach((p, i) => {
      const next = order[order.indexOf(p.rating)+1] || "MAX";
      out.innerHTML += `
        <div class="player">
          <div class="player-info"><b>${p.name}</b>ï½œ${p.rating}ï½œ$${p.salary}M<br>è¨“ç·´é€²åº¦: ${p.trainProgress}% â†’ ${next}</div>
          <button ${p.trained || trainedCount >= trainLimit ? "disabled" : ""} onclick="trainPlayer(${i})">è¨“ç·´</button>
        </div>`;
    });
  }

  window.trainPlayer = (i) => {
    const p = warriors[i];
    if(p.trained) return;
    p.trainProgress += Math.floor(10 + Math.random() * 10);
    p.trained = true;
    if(p.trainProgress >= 100){
      p.trainProgress = 0;
      if(Math.random() < 0.3){
        const idx = order.indexOf(p.rating);
        if(idx < order.length - 1){
          p.rating = order[idx + 1];
          alert(p.name + " å‡ç´šç‚º " + p.rating + "ï¼");
        }
      }
    }
    save(); renderStatus(); showWarriors();
  };

  function showFreeAgents(){
    const out = document.getElementById("freeAgentsDisplay");
    out.innerHTML = "<h2>ğŸ“ è‡ªç”±å¸‚å ´</h2>";
    freeAgents.forEach((p, i) => {
      out.innerHTML += `
        <div class="player">
          <div class="player-info"><b>${p.name}</b>ï½œ${p.rating}ï½œ$${p.salary}M</div>
          <button onclick="signFreeAgent(${i})">ç°½ç´„</button>
        </div>`;
    });
  }

  window.signFreeAgent = (i) => {
    const p = freeAgents[i];
    if(money < p.salary) return alert("è³‡é‡‘ä¸è¶³ï¼");
    if(Math.random()*100 < p.signChance){
      warriors.push({...p, trainProgress:0, trained:false});
      freeAgents.splice(i,1);
      money -= p.salary;
      alert(p.name + " æˆåŠŸç°½ä¸‹ï¼");
    } else {
      alert(p.name + " æ‹’çµ•ç°½ç´„");
    }
    save(); renderStatus(); showWarriors(); showFreeAgents();
  };

  function simulateGame(){
    const today = new Date().toDateString();
    if (lastDate === today) return alert("ä»Šæ—¥å·²æ¨¡æ“¬");
    const opp = otherTeams["é›·éœ†"];
    const ts = warriors.reduce((a, p) => a + ratingMap[p.rating] * (Math.random() + 0.5), 0);
    const os = opp.reduce((a, p) => a + ratingMap[p.rating] * (Math.random() + 0.5), 0);
    const mvp = warriors.reduce((b, p) => {
      const s = ratingMap[p.rating] * (Math.random()+0.5);
      return s > b.score ? {name: p.name, score: s} : b;
    }, {name:"", score:0});
    document.getElementById("gameResult").innerHTML =
      `<h2>ğŸ€ æ¯”åˆ†ï¼š${Math.floor(ts)} : ${Math.floor(os)}</h2><p>MVPï¼š${mvp.name}</p>`;
    lastDate = today; save(); renderStatus();
  }

  function resetTraining(){
    warriors.forEach(p => p.trained = false);
    alert("è¨“ç·´ç‹€æ…‹å·²é‡ç½®");
    save(); showWarriors();
  }

  document.addEventListener("DOMContentLoaded", () => {
    load(); renderStatus(); showWarriors();
    document.getElementById("showWarriorsBtn").onclick = showWarriors;
    document.getElementById("showFreeAgentsBtn").onclick = showFreeAgents;
    document.getElementById("simulateGameBtn").onclick = simulateGame;
    document.getElementById("resetTrainingBtn").onclick = resetTraining;
    document.getElementById("clearBtn").onclick = () => {
      if(confirm("æ¸…é™¤å­˜æª”ï¼Ÿ")) { localStorage.clear(); location.reload(); }
    };
  });
})();
</script>
</body>
</html>